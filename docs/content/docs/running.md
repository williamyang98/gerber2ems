---
title: Running simulation
prev: /docs/configuration
next: /docs/visualise_results
weight: 4
params:
    icon: fast-forward
---

> [!IMPORTANT]
> Make sure that you have initialised the virtual environment following [these instructions]({{< abs_url link="/docs/installation/#use-after-setup" >}}).

## Options
These are the arguments for ```gerber2ems```

{{< gerber2ems_cli_args >}}

## Explanation
These are the following steps taken to go from your exported PCB files to graphs.

| Step | Description |
| --- | --- |
| Convert | Gerber files are converted into images using ```gerbv```. |
| Geometry | PCB image files, via drills, simulation port and PCB stackup configuration are read to produce a single ```geometry.xml``` file. |
| Simulation | openEMS imports the ```geometry.xml``` file and simulation configuration to produce E-field data (if exported) and time domain port measurements for each excitation source. |
| Postprocessing | openEMS data is processed into S-parameters, impedance values (for signal traces and differential traces), and graphs are generated for each of these accordingly |

## Examples
Consider an example where our directory has:
- ```./fab``` generated by KiCAD 8.0 according to [these settings]({{< abs_url link="/docs/export_pcb/#exporting-from-kicad-80" >}}).
- ```./simulation.json``` written according to [these guidelines]({{< abs_url link="/docs/configuration" >}}).
- Virtual environment has been activated according to [these instructions]({{< abs_url link="/docs/installation/#use-after-setup" >}}).
- bash shell is already inside this directory.

```bash {filename="Run entire pipeline and output to default location"}
gerber2ems -a
```

```bash {filename="Run entire pipeline and input/output from custom locations"}
gerber2ems --config "custom_simulation.json" -i "custom_fab/" -o "custom_results/" -a
```

```bash {filename="Run convert to images pass only"}
gerber2ems -c
```

```bash {filename="Run geometry pass only"}
gerber2ems -g
```

```bash {filename="Run simulation pass only"}
gerber2ems -s
```

```bash {filename="Run postprocessing pass only"}
gerber2ems -p
```

```bash {filename="Run simulation with custom number of threads"}
gerber2ems -a --threads 16
```

```bash {filename="Run simulation and export field data"}
gerber2ems -a --export-field
```
